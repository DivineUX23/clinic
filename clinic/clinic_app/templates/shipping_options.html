{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="md:h-screen">
  <div class="grid md:grid-cols-[0.8fr_1fr] h-full">
    <div class="hidden md:block">
      <img src="{% static 'images/shipping_image.png' %}" class="h-full w-full object-cover" alt="Shipping">
    </div>
    <div class="container py-8 px-9" style="text-align: left;">
      <div class="mx-auto max-w-[600px]">
        <div class="mb-8">              
          <a href="{% url 'home' %}" class="md:h-[70px]">
            <!-- Add your logo here -->
          </a>
        </div>
        <h2 class="mb-4 text-purple text-3xl font-bold text-capitalize fs-18-mobile">Choose Your Shipping Option</h2>
        
        <form method="post" action="{% url 'make_payment' order.id %}" class="needs-validation mt-2" autocomplete="off">
          {% csrf_token %}
          
          {% for courier in shipping_rates.couriers %}
          <div class="form-group mb-4 border p-4 rounded-md {% if courier == shipping_rates.cheapest_courier %}border-green-500{% elif courier == shipping_rates.fastest_courier %}border-blue-500{% endif %}">
            <input type="radio" name="chosen_rate" id="courier_{{ courier.service_code }}" value="{{ courier }}" class="mr-2">
            <label for="courier_{{ courier.service_code }}" class="font-semibold">{{ courier.courier_name }}</label>
            <div class="mt-2">
              <p>Delivery ETA: {{ courier.delivery_eta }}</p>
              <p>Price: {{ courier.currency }} {{ courier.total|floatformat:2 }}</p>
              {% if courier.discount.percentage > 0 %}
              <p class="text-green-600">Discount: {{ courier.discount.percentage }}% ({{ courier.currency }} {{ courier.discount.discounted|floatformat:2 }})</p>
              {% endif %}
              {% if courier == shipping_rates.cheapest_courier %}
              <span class="text-green-600 font-bold">Cheapest Option</span>
              {% elif courier == shipping_rates.fastest_courier %}
              <span class="text-blue-600 font-bold">Fastest Option</span>
              {% endif %}
            </div>
          </div>
          {% endfor %}
          
          
          <button class="btn btn--primary btn-block btn-shadow w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-300" type="submit">Proceed to Payment</button>
        </form>
        
        <div class="mt-6 border-t pt-4">
          <h3 class="text-xl font-semibold mb-2">Order Summary</h3>
          <p>From: {{ shipping_rates.checkout_data.ship_from.name }}</p>
          <p>To: {{ shipping_rates.checkout_data.ship_to.name }}</p>
          <p>Package Amount: {{ shipping_rates.checkout_data.currency }} {{ shipping_rates.checkout_data.package_amount|floatformat:2 }}</p>
          <p>Package Weight: {{ shipping_rates.checkout_data.package_weight }} kg</p>
          <p>Pickup Date: {{ shipping_rates.checkout_data.pickup_date }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}